(function (d3) {
  'use strict';

  const loadData = url => {
    return Promise.all([d3.csv(url), d3.json('data.json')]).then(data => {
      const csvData = data[0];
      var jsonData = data[1];
      const artistData = [];

      var genreDict = {};
      var genreHierarchy = d3.hierarchy(jsonData); 
      genreHierarchy.data = jsonData; 
      //console.log(genreHierarchy); 

      const genreList = genreHierarchy.descendants().map(d => d.data.id);

      genreHierarchy.sort((a,b) => {
        const aLen = a.children === undefined ? 0 : a.children.length;
        const bLen = b.children === undefined ? 0 : b.children.length;
        return(bLen - aLen); 
      });
      
      
      genreHierarchy.descendants().forEach(d => {
        const name = d.data.id;
        genreDict[name] = { 
          depth: d.depth,
          plays: 0,
        };  
      });
      
  		//console.log(genreList);
      csvData.forEach(d => {
        if (!artistData[d.artist]) {
          if (d.genre === "")
            return;
          d.genre = d.genre.split(',').map(g => g.replace(/ /g, '')).filter(g => genreList.includes(g));
          d.genreDepths = d.genre.map(g => genreDict[g].depth);

  				artistData[d.artist] = {
            artist: d.artist,
            genre: d.genre,
            genreDepths : d.genreDepths,
            plays: 1
          }; 
        }
        else
  				artistData[d.artist].plays += 1;
      }); 
      
      var toReturn = {};
      toReturn.artistData = artistData;
      toReturn.jsonData = genreHierarchy.data;
      //console.log(toReturn); 
      return toReturn; 
    }).then(r => {return r;});
  };

  const treemap = (selection, props) => {
    const {
      jsonData,
      artistData,
      innerWidth,
      innerHeight,
      playScale
    } = props;
    
    const treeLayout = d3.cluster()
      .size([innerHeight, innerWidth])
      .separation((a, b) => { 
        return (a.parent == b.parent ? 1 : 1); 
      });

    const root = d3.hierarchy(jsonData); 
    
    
    
    var filtArtistData = [];
    Object.keys(artistData).map(k => {
      if (artistData[k].plays > 5)
  			filtArtistData.push(artistData[k]); 
    });
    
    filtArtistData.forEach(f => {
      var deepestGenreIndex = 0;
      for (var i = 0; i < f.genre.length; i++)
  			if (f.genreDepths[i] > f.genreDepths[deepestGenreIndex])
          deepestGenreIndex = i;
      f.deepestGenre = f.genre[deepestGenreIndex];
    });
    //console.log(filtArtistData);
    
    root.descendants().forEach(d => {
      const genre = d.data.id;
      filtArtistData.filter(a => a.deepestGenre === genre).forEach(f => {
        //console.log(f);
        var newNode = d3.hierarchy(f);
        newNode.data.id = newNode.data.artist; 
        newNode.parent = d;  
        if (d.children === undefined)
          d.children = [];
        
        d.children.push(newNode);
      });
    });
    
    // console.log(root); 
    // Todo: Fix this duplicated logic from loadData
    root.sort((a,b) => {
      // console.log(a);
      // console.log('a:' + a.data.id + ' ' + (a.children === undefined ? -1 : a.children.length));
      // console.log('b:' + b.data.id + ' ' + (b.children === undefined ? -1 : b.children.length));
      var aLen = a.children === undefined ? -1 : a.children.length;
      var bLen = b.children === undefined ? -1 : b.children.length;
      // if (a.data.artist)
      //   aLen = 100;
      // if (b.data.artist)
      //   bLen = 100;
      return(bLen - aLen); 
    });
    console.log(root); 
    
    //console.log(root)
    const tree = treeLayout(root);
    const links = tree.links();    
    const linkPathGenerator = d3.linkHorizontal()
      .x(d => d.y)
      .y(d => d.x);

    links.forEach(d => {
      if (d.target.data.artist)
        d.target.y = 750;
      else
    		d.target.y = d.target.depth * 150;
    }); 

    selection.selectAll('path').data(links)
      .enter().append('path')
        .attr('d', linkPathGenerator);

    selection.selectAll('text').data(root.descendants()) 
      .enter().append('text')
        .attr('x', d => d.y)
        .attr('y', d => d.x)
        .attr('dy', '0.32em')
        .attr('text-anchor', d => d.data.artist ? 'start' : 'start')
    		//.attr('font-size', d => d.children ? '1em' : '0.2em')
    		.attr('fill', d => d.data.artist ? playScale(d.data.plays) : 'black')
        .attr('font-size', d => d.data.artist ? Math.log(d.data.plays) * 2 : '0.6em')
        .text(d => d.data.id); 
  };

  const svg = d3.select('svg');
  const width = document.body.clientWidth;
  const height = 2000;//document.body.clientHeight;

  const margin = { top: 0, right: 0, bottom: 0, left: 0};
  const innerWidth = width - margin.left - margin.right;
  const innerHeight = height - margin.top - margin.bottom;

  var jsonData, artistData;
  var playScale;

  const zoomG = svg
      .attr('width', width)
      .attr('height', height)
    .append('g');

  const treeG = zoomG.append('g')
      .attr('transform', `translate(${margin.left},${margin.top})`);

  svg.call(d3.zoom().on('zoom', () => {
    zoomG.attr('transform', d3.event.transform);
  }));



  loadData('https://vizhub.com/OxfordComma/datasets/output-with-genre-2018.csv').then(data => {
    jsonData = data.jsonData;
    artistData = data.artistData;
   	
    playScale = d3.scaleSequential(d3.interpolatePlasma)
  		.domain([0, Object.values(artistData).reduce((maxVal, line) => d3.max([maxVal, line.plays]), 0) + 100]);
    //console.log(colorScale.range())
    render();
  });

  const render = () => {
  	treeG.call(treemap, {
      jsonData,
      artistData,
      innerWidth,
      innerHeight,
      playScale
    });
  };

}(d3));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbIi4uL2xvYWREYXRhLmpzIiwiLi4vdHJlZW1hcC5qcyIsIi4uL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNzdiwgaGllcmFyY2h5LCBqc29uIH0gZnJvbSAnZDMnO1xuXG5leHBvcnQgY29uc3QgbG9hZERhdGEgPSB1cmwgPT4ge1xuICByZXR1cm4gUHJvbWlzZS5hbGwoW2Nzdih1cmwpLCBqc29uKCdkYXRhLmpzb24nKV0pLnRoZW4oZGF0YSA9PiB7XG4gICAgY29uc3QgY3N2RGF0YSA9IGRhdGFbMF07XG4gICAgdmFyIGpzb25EYXRhID0gZGF0YVsxXTtcbiAgICBjb25zdCBhcnRpc3REYXRhID0gW107XG5cbiAgICAvLyBCYWQgdGFncyBpbmNsdWRlZCBpbiB0aGUgZGF0YSBzZXQuIFJlbW92ZWQgYW55dGhpbmcgY291bnRyeS1zcGVjaWZpYyBvciBhbnl0aGluZyBJIGNvbnNpZGVyZWQgJ25vdCBhIGdlbnJlJ1xuICAgIGNvbnN0IGdlbnJlc1RvUmVtb3ZlID0gWydzZWVubGl2ZScsICdmZW1hbGV2b2NhbGlzdHMnLCAnJywgJ2JyaXRpc2gnLCAnamFwYW5lc2UnLCAnb2Z3Z2t0YScsICdpcmlzaCcsICd1c2EnLCAnYXVzdHJhbGlhJywgJ2F1c3RyYWxpYW4nLCAndW5kZXIyMDAwIGxpc3RlbmVycycsICc5MHMnLCAnODBzJywgJzcwcycsICc2MHMnLCAnYWxsJywgJ3BoaWxhZGVscGhpYScsICdzY290dGlzaCcsICdzYW5yZW1vJywgJ25ld3plYWxhbmQnLCAndHdpbmtsZWRhZGRpZXMnLCAnc2FucmVtbzIwMDknLCAncG9saXRpY2FsJywgJ2FtZXJpY2FuJywgJ2NhbmFkaWFuJywgJ2l0YWxpYW4nLCAncHN5Y2hhZGVsaWMnLCAnaW5zdHJ1bWVudGFsJywgJ2FtYmllbnQnLCAnY2hpbGxvdXQnXTtcblxuICAgIC8vIFJlbW92ZSB0aGVzZSBjaGFyYWN0ZXIgZnJvbSB0aGUgZ2VucmUgbmFtZXNcbiAgICBjb25zdCBwdW5jdHVhdGlvblRvUmVtb3ZlID0gWycgJywgJy0nXTtcblxuICAgIHZhciBnZW5yZURpY3QgPSB7fTtcbiAgICB2YXIgZ2VucmVIaWVyYXJjaHkgPSBoaWVyYXJjaHkoanNvbkRhdGEpOyBcbiAgICBnZW5yZUhpZXJhcmNoeS5kYXRhID0ganNvbkRhdGE7IFxuICAgIC8vY29uc29sZS5sb2coZ2VucmVIaWVyYXJjaHkpOyBcblxuICAgIGNvbnN0IGdlbnJlTGlzdCA9IGdlbnJlSGllcmFyY2h5LmRlc2NlbmRhbnRzKCkubWFwKGQgPT4gZC5kYXRhLmlkKTtcblxuICAgIGdlbnJlSGllcmFyY2h5LnNvcnQoKGEsYikgPT4ge1xuICAgICAgY29uc3QgYUxlbiA9IGEuY2hpbGRyZW4gPT09IHVuZGVmaW5lZCA/IDAgOiBhLmNoaWxkcmVuLmxlbmd0aDtcbiAgICAgIGNvbnN0IGJMZW4gPSBiLmNoaWxkcmVuID09PSB1bmRlZmluZWQgPyAwIDogYi5jaGlsZHJlbi5sZW5ndGg7XG4gICAgICByZXR1cm4oYkxlbiAtIGFMZW4pOyBcbiAgICB9KTtcbiAgICBcbiAgICBcbiAgICBnZW5yZUhpZXJhcmNoeS5kZXNjZW5kYW50cygpLmZvckVhY2goZCA9PiB7XG4gICAgICBjb25zdCBuYW1lID0gZC5kYXRhLmlkO1xuICAgICAgZ2VucmVEaWN0W25hbWVdID0geyBcbiAgICAgICAgZGVwdGg6IGQuZGVwdGgsXG4gICAgICAgIHBsYXlzOiAwLFxuICAgICAgfTsgIFxuICAgIH0pXG4gICAgXG5cdFx0Ly9jb25zb2xlLmxvZyhnZW5yZUxpc3QpO1xuICAgIGNzdkRhdGEuZm9yRWFjaChkID0+IHtcbiAgICAgIGlmICghYXJ0aXN0RGF0YVtkLmFydGlzdF0pIHtcbiAgICAgICAgaWYgKGQuZ2VucmUgPT09IFwiXCIpXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICBkLmdlbnJlID0gZC5nZW5yZS5zcGxpdCgnLCcpLm1hcChnID0+IGcucmVwbGFjZSgvIC9nLCAnJykpLmZpbHRlcihnID0+IGdlbnJlTGlzdC5pbmNsdWRlcyhnKSk7XG4gICAgICAgIGQuZ2VucmVEZXB0aHMgPSBkLmdlbnJlLm1hcChnID0+IGdlbnJlRGljdFtnXS5kZXB0aCk7XG5cblx0XHRcdFx0YXJ0aXN0RGF0YVtkLmFydGlzdF0gPSB7XG4gICAgICAgICAgYXJ0aXN0OiBkLmFydGlzdCxcbiAgICAgICAgICBnZW5yZTogZC5nZW5yZSxcbiAgICAgICAgICBnZW5yZURlcHRocyA6IGQuZ2VucmVEZXB0aHMsXG4gICAgICAgICAgcGxheXM6IDFcbiAgICAgICAgfSBcbiAgICAgIH1cbiAgICAgIGVsc2Vcblx0XHRcdFx0YXJ0aXN0RGF0YVtkLmFydGlzdF0ucGxheXMgKz0gMTtcbiAgICB9KTsgXG4gICAgXG4gICAgdmFyIHRvUmV0dXJuID0ge31cbiAgICB0b1JldHVybi5hcnRpc3REYXRhID0gYXJ0aXN0RGF0YTtcbiAgICB0b1JldHVybi5qc29uRGF0YSA9IGdlbnJlSGllcmFyY2h5LmRhdGE7XG4gICAgLy9jb25zb2xlLmxvZyh0b1JldHVybik7IFxuICAgIHJldHVybiB0b1JldHVybjsgXG4gIH0pLnRoZW4ociA9PiB7cmV0dXJuIHI7fSk7XG59O1xuXG5cbiIsImltcG9ydCB7IFxuICBoaWVyYXJjaHksIFxuICBjbHVzdGVyLCBcbiAgc2VsZWN0LFxuXHRsaW5rSG9yaXpvbnRhbCxcbiAgbGlua1ZlcnRpY2FsXG59IGZyb20gJ2QzJztcblxuZXhwb3J0IGNvbnN0IHRyZWVtYXAgPSAoc2VsZWN0aW9uLCBwcm9wcykgPT4ge1xuICBjb25zdCB7XG4gICAganNvbkRhdGEsXG4gICAgYXJ0aXN0RGF0YSxcbiAgICBpbm5lcldpZHRoLFxuICAgIGlubmVySGVpZ2h0LFxuICAgIHBsYXlTY2FsZVxuICB9ID0gcHJvcHM7XG4gIFxuICBjb25zdCB0cmVlTGF5b3V0ID0gY2x1c3RlcigpXG4gICAgLnNpemUoW2lubmVySGVpZ2h0LCBpbm5lcldpZHRoXSlcbiAgICAuc2VwYXJhdGlvbigoYSwgYikgPT4geyBcbiAgICAgIHJldHVybiAoYS5wYXJlbnQgPT0gYi5wYXJlbnQgPyAxIDogMSk7IFxuICAgIH0pXG5cbiAgY29uc3Qgcm9vdCA9IGhpZXJhcmNoeShqc29uRGF0YSk7IFxuICBcbiAgXG4gIFxuICB2YXIgZmlsdEFydGlzdERhdGEgPSBbXTtcbiAgT2JqZWN0LmtleXMoYXJ0aXN0RGF0YSkubWFwKGsgPT4ge1xuICAgIGlmIChhcnRpc3REYXRhW2tdLnBsYXlzID4gNSlcblx0XHRcdGZpbHRBcnRpc3REYXRhLnB1c2goYXJ0aXN0RGF0YVtrXSk7IFxuICB9KVxuICBcbiAgZmlsdEFydGlzdERhdGEuZm9yRWFjaChmID0+IHtcbiAgICB2YXIgZGVlcGVzdEdlbnJlSW5kZXggPSAwO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZi5nZW5yZS5sZW5ndGg7IGkrKylcblx0XHRcdGlmIChmLmdlbnJlRGVwdGhzW2ldID4gZi5nZW5yZURlcHRoc1tkZWVwZXN0R2VucmVJbmRleF0pXG4gICAgICAgIGRlZXBlc3RHZW5yZUluZGV4ID0gaTtcbiAgICBmLmRlZXBlc3RHZW5yZSA9IGYuZ2VucmVbZGVlcGVzdEdlbnJlSW5kZXhdO1xuICB9KVxuICAvL2NvbnNvbGUubG9nKGZpbHRBcnRpc3REYXRhKTtcbiAgXG4gIHJvb3QuZGVzY2VuZGFudHMoKS5mb3JFYWNoKGQgPT4ge1xuICAgIGNvbnN0IGdlbnJlID0gZC5kYXRhLmlkO1xuICAgIGZpbHRBcnRpc3REYXRhLmZpbHRlcihhID0+IGEuZGVlcGVzdEdlbnJlID09PSBnZW5yZSkuZm9yRWFjaChmID0+IHtcbiAgICAgIC8vY29uc29sZS5sb2coZik7XG4gICAgICB2YXIgbmV3Tm9kZSA9IGhpZXJhcmNoeShmKTtcbiAgICAgIG5ld05vZGUuZGF0YS5pZCA9IG5ld05vZGUuZGF0YS5hcnRpc3Q7IFxuICAgICAgbmV3Tm9kZS5wYXJlbnQgPSBkOyAgXG4gICAgICBpZiAoZC5jaGlsZHJlbiA9PT0gdW5kZWZpbmVkKVxuICAgICAgICBkLmNoaWxkcmVuID0gW107XG4gICAgICBcbiAgICAgIGQuY2hpbGRyZW4ucHVzaChuZXdOb2RlKTtcbiAgICB9KVxuICB9KVxuICBcbiAgLy8gY29uc29sZS5sb2cocm9vdCk7IFxuICAvLyBUb2RvOiBGaXggdGhpcyBkdXBsaWNhdGVkIGxvZ2ljIGZyb20gbG9hZERhdGFcbiAgcm9vdC5zb3J0KChhLGIpID0+IHtcbiAgICAvLyBjb25zb2xlLmxvZyhhKTtcbiAgICAvLyBjb25zb2xlLmxvZygnYTonICsgYS5kYXRhLmlkICsgJyAnICsgKGEuY2hpbGRyZW4gPT09IHVuZGVmaW5lZCA/IC0xIDogYS5jaGlsZHJlbi5sZW5ndGgpKTtcbiAgICAvLyBjb25zb2xlLmxvZygnYjonICsgYi5kYXRhLmlkICsgJyAnICsgKGIuY2hpbGRyZW4gPT09IHVuZGVmaW5lZCA/IC0xIDogYi5jaGlsZHJlbi5sZW5ndGgpKTtcbiAgICB2YXIgYUxlbiA9IGEuY2hpbGRyZW4gPT09IHVuZGVmaW5lZCA/IC0xIDogYS5jaGlsZHJlbi5sZW5ndGg7XG4gICAgdmFyIGJMZW4gPSBiLmNoaWxkcmVuID09PSB1bmRlZmluZWQgPyAtMSA6IGIuY2hpbGRyZW4ubGVuZ3RoO1xuICAgIC8vIGlmIChhLmRhdGEuYXJ0aXN0KVxuICAgIC8vICAgYUxlbiA9IDEwMDtcbiAgICAvLyBpZiAoYi5kYXRhLmFydGlzdClcbiAgICAvLyAgIGJMZW4gPSAxMDA7XG4gICAgcmV0dXJuKGJMZW4gLSBhTGVuKTsgXG4gIH0pO1xuICBjb25zb2xlLmxvZyhyb290KTsgXG4gIFxuICAvL2NvbnNvbGUubG9nKHJvb3QpXG4gIGNvbnN0IHRyZWUgPSB0cmVlTGF5b3V0KHJvb3QpO1xuICBjb25zdCBsaW5rcyA9IHRyZWUubGlua3MoKTsgICAgXG4gIGNvbnN0IGxpbmtQYXRoR2VuZXJhdG9yID0gbGlua0hvcml6b250YWwoKVxuICAgIC54KGQgPT4gZC55KVxuICAgIC55KGQgPT4gZC54KTtcblxuICBsaW5rcy5mb3JFYWNoKGQgPT4ge1xuICAgIGlmIChkLnRhcmdldC5kYXRhLmFydGlzdClcbiAgICAgIGQudGFyZ2V0LnkgPSA3NTA7XG4gICAgZWxzZVxuICBcdFx0ZC50YXJnZXQueSA9IGQudGFyZ2V0LmRlcHRoICogMTUwO1xuICB9KTsgXG5cbiAgc2VsZWN0aW9uLnNlbGVjdEFsbCgncGF0aCcpLmRhdGEobGlua3MpXG4gICAgLmVudGVyKCkuYXBwZW5kKCdwYXRoJylcbiAgICAgIC5hdHRyKCdkJywgbGlua1BhdGhHZW5lcmF0b3IpO1xuXG4gIHNlbGVjdGlvbi5zZWxlY3RBbGwoJ3RleHQnKS5kYXRhKHJvb3QuZGVzY2VuZGFudHMoKSkgXG4gICAgLmVudGVyKCkuYXBwZW5kKCd0ZXh0JylcbiAgICAgIC5hdHRyKCd4JywgZCA9PiBkLnkpXG4gICAgICAuYXR0cigneScsIGQgPT4gZC54KVxuICAgICAgLmF0dHIoJ2R5JywgJzAuMzJlbScpXG4gICAgICAuYXR0cigndGV4dC1hbmNob3InLCBkID0+IGQuZGF0YS5hcnRpc3QgPyAnc3RhcnQnIDogJ3N0YXJ0JylcbiAgXHRcdC8vLmF0dHIoJ2ZvbnQtc2l6ZScsIGQgPT4gZC5jaGlsZHJlbiA/ICcxZW0nIDogJzAuMmVtJylcbiAgXHRcdC5hdHRyKCdmaWxsJywgZCA9PiBkLmRhdGEuYXJ0aXN0ID8gcGxheVNjYWxlKGQuZGF0YS5wbGF5cykgOiAnYmxhY2snKVxuICAgICAgLmF0dHIoJ2ZvbnQtc2l6ZScsIGQgPT4gZC5kYXRhLmFydGlzdCA/IE1hdGgubG9nKGQuZGF0YS5wbGF5cykgKiAyIDogJzAuNmVtJylcbiAgICAgIC50ZXh0KGQgPT4gZC5kYXRhLmlkKTsgXG59OyIsImltcG9ydCB7XG4gIHNlbGVjdCxcbiAganNvbixcbiAgY2x1c3RlcixcbiAgaGllcmFyY2h5LFxuICBsaW5rSG9yaXpvbnRhbCxcbiAgem9vbSxcbiAgZXZlbnQsXG4gIHNjYWxlU2VxdWVudGlhbCxcbiAgbWF4LFxuICBpbnRlcnBvbGF0ZVBsYXNtYVxufSBmcm9tICdkMyc7XG5pbXBvcnQgeyBsb2FkRGF0YSB9IGZyb20gJy4vbG9hZERhdGEnO1xuaW1wb3J0IHsgdHJlZW1hcCB9IGZyb20gJy4vdHJlZW1hcCc7XG5cbmNvbnN0IHN2ZyA9IHNlbGVjdCgnc3ZnJyk7XG5jb25zdCB3aWR0aCA9IGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGg7XG5jb25zdCBoZWlnaHQgPSAyMDAwLy9kb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodDtcblxuY29uc3QgbWFyZ2luID0geyB0b3A6IDAsIHJpZ2h0OiAwLCBib3R0b206IDAsIGxlZnQ6IDB9O1xuY29uc3QgaW5uZXJXaWR0aCA9IHdpZHRoIC0gbWFyZ2luLmxlZnQgLSBtYXJnaW4ucmlnaHQ7XG5jb25zdCBpbm5lckhlaWdodCA9IGhlaWdodCAtIG1hcmdpbi50b3AgLSBtYXJnaW4uYm90dG9tO1xuXG52YXIganNvbkRhdGEsIGFydGlzdERhdGE7XG52YXIgcGxheVNjYWxlO1xuXG5jb25zdCB6b29tRyA9IHN2Z1xuICAgIC5hdHRyKCd3aWR0aCcsIHdpZHRoKVxuICAgIC5hdHRyKCdoZWlnaHQnLCBoZWlnaHQpXG4gIC5hcHBlbmQoJ2cnKTtcblxuY29uc3QgdHJlZUcgPSB6b29tRy5hcHBlbmQoJ2cnKVxuICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlKCR7bWFyZ2luLmxlZnR9LCR7bWFyZ2luLnRvcH0pYCk7XG5cbnN2Zy5jYWxsKHpvb20oKS5vbignem9vbScsICgpID0+IHtcbiAgem9vbUcuYXR0cigndHJhbnNmb3JtJywgZXZlbnQudHJhbnNmb3JtKTtcbn0pKTtcblxuXG5cbmxvYWREYXRhKCdodHRwczovL3Zpemh1Yi5jb20vT3hmb3JkQ29tbWEvZGF0YXNldHMvb3V0cHV0LXdpdGgtZ2VucmUtMjAxOC5jc3YnKS50aGVuKGRhdGEgPT4ge1xuICBqc29uRGF0YSA9IGRhdGEuanNvbkRhdGE7XG4gIGFydGlzdERhdGEgPSBkYXRhLmFydGlzdERhdGE7XG4gXHRcbiAgcGxheVNjYWxlID0gc2NhbGVTZXF1ZW50aWFsKGludGVycG9sYXRlUGxhc21hKVxuXHRcdC5kb21haW4oWzAsIE9iamVjdC52YWx1ZXMoYXJ0aXN0RGF0YSkucmVkdWNlKChtYXhWYWwsIGxpbmUpID0+IG1heChbbWF4VmFsLCBsaW5lLnBsYXlzXSksIDApICsgMTAwXSk7XG4gIC8vY29uc29sZS5sb2coY29sb3JTY2FsZS5yYW5nZSgpKVxuICByZW5kZXIoKTtcbn0pXG5cbmNvbnN0IHJlbmRlciA9ICgpID0+IHtcblx0dHJlZUcuY2FsbCh0cmVlbWFwLCB7XG4gICAganNvbkRhdGEsXG4gICAgYXJ0aXN0RGF0YSxcbiAgICBpbm5lcldpZHRoLFxuICAgIGlubmVySGVpZ2h0LFxuICAgIHBsYXlTY2FsZVxuICB9KTtcbn0iXSwibmFtZXMiOlsiY3N2IiwianNvbiIsImhpZXJhcmNoeSIsImNsdXN0ZXIiLCJsaW5rSG9yaXpvbnRhbCIsInNlbGVjdCIsInpvb20iLCJldmVudCIsInNjYWxlU2VxdWVudGlhbCIsImludGVycG9sYXRlUGxhc21hIiwibWF4Il0sIm1hcHBpbmdzIjoiOzs7RUFFTyxNQUFNLFFBQVEsR0FBRyxHQUFHLElBQUk7RUFDL0IsRUFBRSxPQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQ0EsTUFBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFQyxPQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUk7RUFDakUsSUFBSSxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDNUIsSUFBSSxJQUFJLFFBQVEsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDM0IsSUFBSSxNQUFNLFVBQVUsR0FBRyxFQUFFLENBQUM7QUFDMUIsQUFNQTtFQUNBLElBQUksSUFBSSxTQUFTLEdBQUcsRUFBRSxDQUFDO0VBQ3ZCLElBQUksSUFBSSxjQUFjLEdBQUdDLFlBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztFQUM3QyxJQUFJLGNBQWMsQ0FBQyxJQUFJLEdBQUcsUUFBUSxDQUFDO0VBQ25DOztFQUVBLElBQUksTUFBTSxTQUFTLEdBQUcsY0FB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